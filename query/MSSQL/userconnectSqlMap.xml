<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="userconnectSqlMap">
	<update id="loginInitialization" parameterType="UserConnectVO">
		update p_user_connect
		set connect_fail_cnt=0
		where user_id=#{user_id}
    </update>
    
    <select id="getUserConnect" parameterType="UserConnectVO" resultType="UserConnectVO">
    	select * from p_user_connect
    	where user_id=#{user_id}
    </select>
    
    <insert id="insertUserConnect" parameterType="UserConnectVO">
    	insert into p_user_connect(user_id, first_con_date, last_con_date, connect_fail_cnt, session_id, remote_ip, reg_id, reg_date)
    	values(#{user_id}, #{first_con_date}, #{last_con_date}, 0, #{session_id}, #{remote_ip}, #{reg_id}, #{reg_date})
    </insert>
    
    <update id="updateUserConnect" parameterType="UserConnectVO">
    	update p_user_connect
    	set last_con_date = #{last_con_date},
    		mod_id = #{mod_id},
    		mod_date = #{mod_date},
    		remote_ip = #{remote_ip}
    	where user_id = #{user_id}
    </update>
    
     <update id="updateUserRemoteIp" parameterType="UserConnectVO">
    	update p_users
    	set remote_ip = #{remote_ip}
    	where user_id = #{user_id}
    </update>
    
    <update id="resetDateFail" parameterType="UserConnectVO">
    	update p_user_connect
    	set first_con_date = #{first_con_date},
    		connect_fail_cnt=0,
    		mod_id = #{mod_id},
    		mod_date = #{mod_date}
    	where user_id = #{user_id}
    </update>
    
    <update id="resetConnectFailCnt" parameterType="UserConnectVO">
    	update p_user_connect
    	set connect_fail_cnt=0,
    		mod_id = #{mod_id},
    		mod_date = #{mod_date}
    	where user_id = #{user_id}
    </update>
    
    <update id="upConnFailCnt" parameterType="UserConnectVO">
    	update p_user_connect
    	set connect_fail_cnt = #{connect_fail_cnt},
    		mod_id = #{mod_id},
    		mod_date = #{mod_date}
    	where user_id = #{user_id}
    </update>
</mapper>