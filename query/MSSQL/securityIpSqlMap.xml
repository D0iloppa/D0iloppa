<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="securityIpSqlMap">
	<insert id="insertIpUseYN" parameterType="SecurityIpVO">
		insert into p_white_ip_use(
							white_ip_use_yn,
							reg_id,
							reg_date)
		values(
			#{white_ip_use_yn},
			#{reg_id},
			#{reg_date})
	</insert>
	<update id="updateIpUseYN" parameterType="SecurityIpVO">
		update p_white_ip_use
		set white_ip_use_yn=#{white_ip_use_yn},
			mod_id=#{mod_id},
			mod_date=#{mod_date}
	</update>
	<select id="getIpUseYN" resultType="SecurityIpVO">
		select * from p_white_ip_use
	</select>
	
	<select id="getSecurityIpList" resultType="SecurityIpVO">
		select * from p_white_ip_list
		order by seq desc
	</select>
	
	<select id="getSecurityUser_Id_IpList" parameterType="String" resultType="SecurityIpVO">
		SELECT * from p_white_ip_list
		WHERE ip_lvl = 'P' AND ip_val = #{value} 
		ORDER BY seq desc
	</select>
	
	<insert id="insertIp" parameterType="SecurityIpVO">
		insert into p_white_ip_list
		(
			ip_lvl,
			ip_val,
			ip_range,
			ip_addr,
			reg_id,
			reg_date)
		values(
			#{ip_lvl},
			#{ip_val},
			#{ip_range},
			#{ip_addr},
			#{reg_id},
			#{reg_date})
	</insert>
	
	<update id="upSecurityIp" parameterType="SecurityIpVO">
		update p_white_ip_list
		set ip_lvl=#{ip_lvl},
			ip_val=#{ip_val},
			ip_range=#{ip_range},
			ip_addr=#{ip_addr},
			mod_id=#{mod_id},
			mod_date=#{mod_date}
		where seq = #{seq}
	</update>
	<delete id="deleteSecurityIp" parameterType="SecurityIpVO">
		delete from p_white_ip_list
		where seq=#{seq}
	</delete>
	
	<select id="getUserInfo" parameterType="String" resultType="UsersVO">
		SELECT user_id,user_kor_nm
		from p_users
		where user_id = #{value}
	</select>
	
	<select id="getOrgLabel" parameterType="Long" resultType="String">
		SELECT org_nm
		from p_organization
		where org_id = #{value}
	</select>
	
	
	<select id="getOrgList" parameterType="String" resultType="OrganizationVO">
		SELECT pou.org_id,org_path
		FROM p_organization_user pou LEFT OUTER JOIN p_organization po ON (pou.org_id = po.org_id) 
		WHERE user_id = #{value}
	</select>
	
	<select id="getSecurityOrgIpList" parameterType="String" resultType="SecurityIpVO">
		SELECT *
		FROM p_white_ip_list
		WHERE ip_lvl = 'O' AND ip_val = #{value}
	</select>
	
	
</mapper>